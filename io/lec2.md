Лекция 2. Аппаратные интерфейсы вычислительных систем

 # Аппаратные интерфейсы | уровни описания
 
## На физическом уровне определяются:

• Набор сигнальных линий

• Типы соединительных элементов

• Характеристики сигналов

• Нагрузочная способность линий
связи

• Физическая топология

• Максимальная длина линий связи

• Требования к помехоустойчивости
и заземлению

## На логическом уровне определяются:

• Формат пакетов данных

• Логическая топология

• Протокол передачи данных

• Система адресации

_как даются данные, в какой последовательности, порядок взаимодействия ведущего/ведомого_



# Основные характеристики интерфейсов

1. Скорость передачи данных (пропускная способность)

2. Способ передачи слова данных (параллельный,
последовательный)

3. Протяженность линий связи

4. Количество подключаемых устройств

5. Топология

6. Наличие синхронизации (синхронный, асинхронный) 

_никак не относится к типу передачи данных: т.е. синхронный-асинхронны обмен -- при синхронном передатчик знает как работает приемник 
и без задержек или с детерминированными задержками передает данные, не проверя дошли они или нет, потому что он уверен, что данные дошли,
асинхронное -- когдп передатчик не знает, когда готов приемник и поэтому ему надо или опрашивать, или работать по прерыванию_

_в свою очередь, синхронизация в интерфейсах -- это наличие или отсутствие отдельной выделенной линии, которая синхронизирует прием или 
отправку битов данных. Если она есть -- то интерфейс считается синхронным, если нет -- асинхронным_

7. Возможные направления передачи данных
(симплексный, полудуплексный, дуплексный)

_симплексный -- передача в одну сторону, дуплекстный -- в две стороны, полудуплексный -- в две стороны, но по-очереди (с временным мультиплексированием)_



# Типы передаваемых данных

По функциональному
назначению различают:

• Прикладные данные

• Адрес

• Данные управления

Различные типы данных могут
передаваться как на физическом, так
и на логическом уровне.

На физическом уровне для разных
типов данных выделяют отдельные
сигнальные линии.

На логическом уровне для разных
типов данных выделяют
специальные поля на уровне пакетов
передачи данных.

<img src="https://sun9-62.userapi.com/impf/k1x7txl1SfjU7NxLTDZz0NiMpxHiQIcsgSZqjA/dQCIXvSCILI.jpg?size=272x166&quality=96&proxy=1&sign=695ae1d229ec25ff0caee23da145151c&type=album">

1 рисунок:

Все эти данные можно передавать по отдельным лиеиям связи (шина адреса, шина данных, сигналы read/write). При этом увеличивается производительность интерфейса, но это невозможно при передачи данных на большие расстояния, потому что сигналы затухают.

2 рисунок:

Второй способ: перенос всех данныхЫ на другой уровень: управляющий и выше. Тогда между мастером и слейвом будет только одна линия данных, по которой передаются данные. При этом эта линия не разделяется, а парсинг и анализ этих данных идет на приемной стороне, для этого необходимо обозначить протокол для описания того, как передаются данные. 
Плюс: экономия физическиих линий связи.
Минус: усложнение контроллеров интерфейсов ввода-вывода.

Существуют промежуточные варианты, где адрес и сигналы передается по одной линии, а данные -- по другой.

Это упращенное представление: в настоящих шинах передаются всякие метки и другая информация.



# Схемы подключения устройств

<img src="https://sun9-75.userapi.com/impf/LOOnX7kr7bz7ZP37-SlJSEmiUnqu7JIG0bRHAQ/LiUtyStzCLE.jpg?size=1020x363&quality=96&proxy=1&sign=9ae5c5f3dd9f07d6fabbbd88ebf9661e&type=album">


# Виды синхронизации

<img src="https://sun9-60.userapi.com/impf/cREBNnfYPi3JIHegKBxngOU5iNkvd4VB7n3bHg/Ey0orHq6tok.jpg?size=1034x584&quality=96&proxy=1&sign=c69ba00f6681cf04670fd46cc84661eb&type=album">

__Асинхронный интерфейс__ -- это тот интерфейс, который не содержит никакой доп.линии синхронизации и синхронизация осуществляется на протокольном (канальном) уровне при помощи стартовых и стоповых бит, которые позволяют отличить одну посыдку от другой. 

Примеры асинхронных интерфейсов -- RS 232, USB, SATA, PCI Express

__Синхронные интерфейсы__ -- те интерфейсы, в которых есть отдельные линии синхронизации. 

Примеры -- SPI, I2C

Позволяет передавать на больше расстояния -- асинхронные, потому что не нужно поддерживать в стабильном уровне сигнал синхронизации. При этом помехи принято обнаруживать просто при помощи помехоустойчивых кодов.

Позволяет передавать с большей скоростью -- синхронные, потому что не нужно передавать дополнительные биты (стартовые, стоповые, доп биты из-за помехоустойчевого кодирования). Кроме того, могут быть больше частоты.



# Интерфейс I2C

__I²C (Inter Integrated Circuit)__ -- последовательная шина
данных для связи интегральных схем, использующая две
двунаправленные линии связи (SDA _по которому шлются данные_ и SCL _для синхронизации_). 

<img src="https://sun9-11.userapi.com/impf/8aTjlvl7juga51D7WMJu-NaBa-tSr7LkvvwmNg/ESBn6G9-zyI.jpg?size=999x374&quality=96&proxy=1&sign=7470ef8b504bf95427fb211313331dff&type=album">

Используется до сих пор для того, чтобы связывать устройства на материнской плате и передавать данные на которкие растояния.

Подключается по общей шине, поэтому к одной линии можно подключить несколько устройств (в том числе несколько мастеров).

В I2C используется, как правило, однотактный выход с внешней нагрузкой (на картинке видно, что резисторы стоят вне). Двухтактиный нельзя использовать потому что он на выход подает сильную единицу и сильный нуль, и если кто-то еще, подключенный к этой линии, внезапно поставит на ней сигнал другой полярности, получится короткое замыкание, так как будут подключены точки с разным потенциалом. 
Однотактный с _внутренней_ нагрузкой может быть подключен, если мы сопрягаем устройства, которые работают на одинаковых напряжениях питания и при этом понятен уровень сигнала логической единицы.
Для того, чтобы не завязываться на напряжении подключают _однотактный выход с внешней нагрузкой_, подтягивающими резисторами оно будет подтягиваться к одинаковым, ожидаемым значениям. 


## Характеристики интерфейса I2C

- Полудуплексный канал передачи данных

- Количество сигнальных линий: 2

- Роли устройств: ведущий, ведомый

- Поддерживается режим работы с
множеством ведущих (на практике не используется)

- Синхронный интерфейс



## I2C | подключение ведомых по схеме монтажного И

<img src="https://sun9-8.userapi.com/impf/FnYROXVVWIi802JQG--0PVu0CFa-mOQgL9W3mg/bK2DBnW32YI.jpg?size=914x492&quality=96&proxy=1&sign=7b58f693d7d86998f105d83046f1cf3c&type=album">

 __подключение ведомых по схеме монтажного И__ -- если один из ведомых устройств опускает линию в 0, тогда все, независимо от того, что передают, слушают 0 на линии.Единица создается одним источником, а для нуля есть множество источников и они не конфликтуюют друг с другом.
 
 <img src="https://sun9-46.userapi.com/impf/Ts-X0UcOvYx4SQy4VcRaX9Io5_-f0O-T6XAUqQ/0D4CpyzfMkQ.jpg?size=948x495&quality=96&proxy=1&sign=00b5974e407f0d9f1af02d55229c0d9b&type=album">
 
 
 ## I2C | протокол передачи данных 
 
 <img src="https://sun9-46.userapi.com/impf/Ts-X0UcOvYx4SQy4VcRaX9Io5_-f0O-T6XAUqQ/0D4CpyzfMkQ.jpg?size=948x495&quality=96&proxy=1&sign=00b5974e407f0d9f1af02d55229c0d9b&type=album">
 
  целом, в синхронных устройствах используются 2 типа передачи данных -- либо данные валидные в момент уровня сигнала синхронизации (как на картинке), либо в сосент фронта сигнала (в момент перепада).
  
  
  <img src="https://sun9-44.userapi.com/impf/SorcFWxz8B1hFUzpX_rfy-UzdzNZBjKrlAX6VQ/9xHKhbIxMMo.jpg?size=1044x428&quality=96&proxy=1&sign=482ebdd75228b8356c19a102b64e8b77&type=album">
  
  Здесь видны стартовые и стоповые сигналы для увеличения вероятности начала распознования данных и конца. После каждых 8-ми бит идет подтверждение (ACK).  Приемник может принудительно перевести передатчик в 0, для того, чтобы приемник подождал. Это обеспечивается соединение устройств по монтажному И.
  
 ## Состояния СТАРТ и СТОП (1)

__состояние СТАРТ:__ переход сигнала линии SDA из ВЫСОКОГО состояния
в НИЗКОЕ при ВЫСОКОМ уровне на линии SCL.

__состояние СТОП:__ переход состояния линии SDA из низкого состояния
в ВЫСОКОЕ при ВЫСОКОМ состоянии линии SCL


<img src="https://sun9-2.userapi.com/impf/TgeKSjQ4c5a0oSSjDeiMtZQhVupS2-T0RGZePg/lFdTx3nSe5o.jpg?size=1028x476&quality=96&proxy=1&sign=265781b221a263e4bb1d7a247e886e37&type=album">



## Адресация в шине I2C

<img src="https://sun9-24.userapi.com/impf/q55jOQHNUurQMwseyupti6qmMi9_-dydNqGxVQ/Ucn4S8-Yn50.jpg?size=889x450&quality=96&proxy=1&sign=e6806bd89cc25a66d8643b2da03a1adb&type=album">

## Полный формат операции записи

<img src="https://sun9-8.userapi.com/impf/iMbr9PFSxhu6tUdgdEEEM1evu6Mb99fvj3JomQ/3lPUI49SAjk.jpg?size=1051x397&quality=96&proxy=1&sign=0ccd77029a7ead15355e37ae9058e058&type=album">

## Полный формат операции чтения

<img src="https://sun9-52.userapi.com/impf/5CpqU54LLecERoVu4RMVvRje4IHVIT8UFheY2w/GJrP7MKUiV8.jpg?size=951x386&quality=96&proxy=1&sign=c6f2a990fd6e3e3e51a4c4f57844b267&type=album">
