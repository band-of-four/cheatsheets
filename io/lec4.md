# Лекция 4

# Беспроводные линии связи


## Инфракрасный канал 

__Инфракрасный канал__ – канал, в котором информация
передается посредством модулированного света с длиной
волны около 800 нм.

__Особенности:__

- Устойчив к электромагнитным помехам
- Не проходит через препятствия (стены и т.п.)
- Низкое энергопотребление источника и передатчика
- Зависит от параметров окружения (влажность, осадки и др.)
- Не виден глазу человека, поэтому не ослепляет 
- используется не только для передачи утройство-устройство
- позволяет передавать данные до Гбит в секунду
- не устарела
- чаще всего информация кодируется с помощью имульсов света 
- широко распростренены в авиа и морской индустрии, когда нельзя вводить доп.шумы в эфир.
- обладает высокой степернью защиты (сложно поймать и заметно)
 
__Спецификации интерфейсов IrDA:__

1. SIR 9,6–115,2 Кбит/с
2. HDLC 0,576 и 1,152 Мбит/с
3. FIR 4 Мбит/с
4. VFIR 16 Мбит/с
5. UFIR 96 Мбит/с
6. Giga-IR 1 Гбит/с


## Узкополосный канал

__Узкополосный сигнал__ – это сигнал, вся мощность
которого концентрируется на одной частоте и занимает
небольшой диапазон радиочастотного спектра

_передется на одной частоте, есть несущая и информационные составляющие, несущие моделируются информационным сигналом и передается приемнику_

__Особенности:__

- Высокий уровень создаваемых помех
- данные занимают соответствующий информационный диапазон
- Необходим мощный передатчик
- сильные передатчики позволяют покрыть большую площадь
- чувствительны к помехам
- легко организовать
- не нужно дорогостоящее оборудовние
- узкокополосный сигнал нельзя использовать, иначе быстро займутся все частоты 

__Примеры:__

- AM-, FM-радио


 ## Широкополосный сингал
 
 __Широкополосный сигнал__ – это шумоподобный сигнал
(ШПС), занимающий большой диапазон частот.
 
_информация передается не по какому-то узкому каналу, а на нескольких частотах в рамках некого чистотного диапазона, при этом в этом диапазоне могут передаваться разные технологии_ 

 __Особенности:__
 
- Низкий уровень создаваемых помех
- Необходимы дополнительные манипуляции по
расширению спектра
- то, что передается - избыточно.

__Примеры:__

- ZigBee
- Bluetooth
- Wi-Fi

__Методы расширения спектра:__

- DSSS
- FHSS

_используются в разных технологиях и позволяют увеличить спектр и при этом уменьшить мощность в каждом подчистотном диапазоне_


## DSSS

__DSSS__ (Direct Sequence Spread Spectrum) – расширение
спектра методом прямой последовательности.

- Вся используемая полоса частот делится на некоторое
число подканалов (например, в стандарте 802.11 11
каналов).
- Каждый передаваемый бит информации
превращается, по заранее зафиксированному
алгоритму, в последовательность из 11 бит, и эти 11 бит
передаются одновременно и параллельно, используя
все 11 подканалов.
- Каждая пара приемника и передатчика имеет свою
систему кодировки.
- можно восстановить данные при потере
- Пример использования: Wi-Fi


## Метод FHSS
__FHSS__ (Frequency-Hopping Spread Spectrum) – расширение
спектра методом частотных скачков.

- Вся отведенная для передач полоса частот
подразделяется на некоторое количество подканалов (по
стандарту 802.11 этих каналов 79).
- Каждый передатчик в каждый данный момент
использует только один из этих подканалов, регулярно
перескакивая с одного подканала на другой.
- Скачки происходят синхронно на передатчике и
приемнике в заранее зафиксированной
псевдослучайной последовательности, известной обоим.
- Пример использования: Bluetooth



# Технологии

## ZigBee

__ZigBee__ — протокол верхнего уровня,
базирующийся на беспроводном стандарте
IEEE 802.15.4.

У истоков протокола стоит организация
ZigBee Alliance, отвечающая за его развитие
и продвижение, а также за сертификацию
оборудования.


Строится по mesh-топологии, связывает 3 вда устройств: координатор, роутер и конечный узел, предназначен для объединение в сеть маломощных приемников и передатчиков для организации сбора данных с датчиков температур, влажности.

Характеризуется малой скоростью передачи данных, но долгосрочной работой от одной батарейки и большой дальностью передачи данных.

![image](https://user-images.githubusercontent.com/27426287/112755858-4012ea00-8feb-11eb-8e25-2851a68a3968.png)

### Типы узлов:

- __Координатор__ запускает сеть и управляет ею,
устанавливает политику безопасности.

- __Маршрутизатор (роутер)__ транслирует пакеты,
осуществляет динамическую маршрутизацию,
восстанавливает маршруты при перегрузках в сети
или отказе какого-либо устройства.

- __Конечное устройство__ может принимать и
отправлять пакеты, но не занимается их трансляцией
и маршрутизацией.

### Дальность, скорость, энергопотребление

- Расстояние между рабочими станциями сети составляет десятки
метров внутри помещений и сотни метров на открытом воздухе.

- «Брутто» скорость (включая служебную информацию) составляет
250 кбит/c. Средняя скорость передачи полезных данных, в
зависимости от загрузки сети и числа ретрансляций, составляет от 5
до 40 кбит/с.

- Устройства ZigBee отличаются низким электропотреблением, в
особенности конечные устройства, для которых предусмотрен режим
«сна», что позволяет этим устройствам работать до трех лет от одной
обычной батарейки АА или ААА;

### Сфера применения

- Системы автоматизации жизнеобеспечения домов и строений
(удаленное управление сетевыми розетками, выключателями, реостатами
и т. д.).

- Системы управления бытовой электроникой.

- Системы автоматического снятия показаний с различных счетчиков (газа,
воды, электричества и т. д.).

- Системы безопасности (датчики задымления, датчики доступа и охраны,
датчики утечки газа, воды, датчики движения и т. д.).

- Системы мониторинга окружающей среды (датчики температуры,
давления, влажности, вибрации и т. д.).

- Системы промышленной автоматизации.



## X-Bee

- Полноценные ZigBee-модули, поддерживающие спецификацию
ZigBee-2007 и позволяющих построить mesh-сеть, включающую
спящие и мобильные устройства.

- Максимальная пропускная способность примерно равна 35 кбит/с

- Основной режим работы модулей XBee — это работа под
управлением внешнего микроконтроллера, управляющего
модулем с помощью простых AT-команд или упорядоченных
структур данных (режим API)

### Варианты использования

- Работа с внешними датчиками, которые выдают значения параметров в
виде аналогового напряжения или имеют выходы с двумя состояниями —
«включено/выключено»
- XBee-модуль напрямую сопрягается с любыми устройствами, имеющими
UART-интерфейс

- При самостоятельной работе XBee-модуль может передавать данные по
заданному расписанию, отправляя их через определенные промежутки
времени, или по изменению состояния сигнала на цифровом порту

- В сетях с mesh-топологией данные будут доходить до узла сбора
информации с переменной задержкой, которую необходимо учитывать
при принятии решения о недоставке сообщения и, соответственно,
повторных попытках передачи



## Bluetooth

__Bluetooth__ — международный стандарт беспроводных
коммуникаций малого радиуса действия.

Основное назначение Bluetooth — обеспечение экономичной
радиосвязи между различными типами электронных
устройств, причём немалое значение придается компактности
электронных компонентов, что даёт возможность применять
Bluetooth в малогабаритных приборах.

### Подключение

Топологии звезда, различные виды реализаций: 

![image](https://user-images.githubusercontent.com/27426287/112756400-a8fb6180-8fed-11eb-8d78-5332cc7afffd.png)

а) подключение ведущий-ведомый
б) подключение с одним ведущим и несколькими ведомыми
в) подключение с несколькими ведущими и ведомыми (на практике встреяаетя редко)

### Стек протоколов

![image](https://user-images.githubusercontent.com/27426287/112756453-ecee6680-8fed-11eb-8b2c-bba56339061f.png)

_отдельные виды трафика идут в обход нескольких стадий стека (аудио, видео)_

__Уровень физических радиосигналов__ (Physical) описывает частоты и
мощности сигналов, используемых для передачи информации.

__Уровень базового диапазона частот__ (Baseband) отвечает за
организацию каналов передачи данных в радиосреде. В его
обязанности входят выбор последовательности псевдослучайной
перестройки частоты, синхронизация устройств в пикосети,
формирование и передача кадров по установленным каналам. Кадр
Bluetooth имеет переменную длину, поле данных может содержать от 0
до 2744 бит (343 байт). Для передачи голоса используются кадры
фиксированного размера с полем данных 240 бит (30 байт).

__Диспетчер каналов__ (LMP) отвечает за аутентификацию устройств и
шифрование трафика, а также управляет статусом устройств, то есть
может сделать подчиненное устройство главным, и наоборот.

__Уровень протокола адаптации для управления логическим каналом__
(Logical Link Control Adaptation Protocol, L2CAP) является верхним
уровнем протоколов ядра Bluetooth. Этот протокол используется только
в тех случаях, когда устройство передает данные; голосовой трафик
обходит этот протокол и обращается непосредственно к уровню
базового диапазона частот. Уровень L2CAP принимает от протоколов
верхнего уровня сегменты данных размером до 64 Кбайт и делит их на
небольшие кадры для уровня базового диапазона частот.

__Аудиоуровень__ обеспечивает передачу голоса. На этом уровне
применяется импульсно-кодовая модуляция (РСМ), что определяет
скорость голосового канала в 64 Кбит/с.

__Уровень управления__ передает информацию о состоянии соединений и
принимает команды, изменяющие конфигурацию и состояние
соединений.


### Bluetooth. Дальность

Рабочий диапазон устройств зависит от их класса:

- Класс 3 –дальность до 1 метра.
- Класс 2 – дальность до 10 метров – наиболее
распространен в мобильных устройствах.
- Класс 1 – диапазон до 100 метров – используется
преимущественно в промышленности.

Bluetooth 5 увеличивает диапазон Bluetooth 4.0 до 60
метров.

_на практике больше 10 метров редко используется, к тому же блютуз плохо переносит стены и различные преграды, в промышленности вместо блютуза 1-го класса принято использовать ZigBee_

### Помехоустойчивость. Энергопотребление

В Bluetooth используется технология адаптивной смены
частоты (adaptive frequency hopping (AFH)) с целью
уменьшения помех, возникающих при совместной работе
других технологий, использующих диапазон частот 2,4 ГГц.

Наиболее часто используемые устройства потребляют 2,5 мВт. _(сравнимо с ZigBee)_

_вообще, что bluetuth, что wi-fi можно организовать так, чтобы они были по потреблению сравнимы с ZigBee, только наоборот, чтобы ZigBee был по скорости сравним с блютузом и вай-фаем невозможно_

### Сфера применения

- Основным направлением использования Bluetooth является
создание персональных сетей (PAN, или private area networks),
включающих такие разноплановые устройства, как мобильные
телефоны, PDA, МР3-плееры, компьютеры и даже микроволновые
печи и холодильники.
- Возможность передачи голоса позволяет встраивать интерфейс
Bluetooth в беспроводные телефоны или, например, беспроводные
гарнитуры для сотовых телефонов.

- Узлами персональной сети могут быть любые устройства,
имеющие потребность в получении информации или обладающие
необходимой информацией.



## Wi-Fi

__Wi-Fi__ (англ. Wireless Fidelity — «беспроводная точность»)
— стандарт на оборудование Wireless LAN.

Wi-Fi – это протокол беспроводной передачи данных,
помогающий соединить n-ное количество компьютеров в
сеть, либо подключить их к интернету, с малым радиусом
действия, использующий радиоволны.

### Стек протоколов 

_построен на стеке протоколов, котоые реализются в сетях локальных ethernet'а, с отличием в физическом уровне и уровень доступа к среде (mac-уровень), потому что среда передачи - это радио, и доступ есть либо централизованный, либо не централизованный (PCF, DCF)_

![image](https://user-images.githubusercontent.com/27426287/112758284-2dea7900-8ff6-11eb-9a83-43ac9b2c44f5.png)

__Физический уровень__ IEEE 802.11x - радиоканал. Этот уровень
характеризует параметры физической среды передачи данных.

__Канальный уровень__ осуществляет управление доступом к
передающей среде и обеспечивает пересылку кадров между
любыми двумя устройствами беспроводной сети. После того,
как доступ к среде получен, ею может воспользоваться
подуровень LLC. Подуровень LLC, организующий передачу
кадров информации, один и тот же в беспроводных сетях Wi-Fi
и в кабельных сетях с архитектурой Ethernet.

__MAC-уровень__

В сетях 802.11 уровень MAC обеспечивает два режима доступа
к разделяемой среде:

_разница в таймингах, с которыми идут повторения посылок и прослушивания эфира для обнаружения коллизий и начинать передачу данных - либо централизованно, либо расспределенно_

- распределенный режим DCF (Distributed Coordination
Function);
- централизованный режим PCF (Point Coordination Function).

_весь стек протоколов выше - такой же как в любых протоколах локальных сетей_

### Скорость, дальность, энергопотребление

- Скорость передачи данных для Wireless оборудования,
поддерживающего стандарт 802.11b, не превышает 11 Мбит/с, а для
оборудования, поддерживающего стандарт 802.11g, до 54 Mбит/с.
Стандарт 802.11n способен обеспечить скорость передачи данных до
600 Мбит/с. Для 802.11a скорость передачи данных - 54 Мбит/c.
- Диапазон частот — 2,4 или 5 ГГц;
- Радиус действия — до 100 метров.
- При передаче данных посредством сети 802.11ас используются более
широкие каналы и повышенная частота, что увеличивает
теоретическую скорость до 1,3 Гбит/с. На практике пропускная
способность составляет до 600 Мбит/с. Кроме того, устройство на базе
802.11ас передаёт больше данных за один такт.
- Высокое по сравнению с другими стандартами потребление энергии,
что уменьшает время жизни батарей и повышает температуру
устройства.



## LoRaWAN

- Сеть LoRaWAN (Long Range wide-area networks)
предназначена для обслуживания IoT-устройств
- LoRaWAN строится на топологии «звезда». Множество
устройств по беспроводному соединению передают
данные на несколько шлюзов
- Шлюзы, получившие информацию, перенаправляют
полученные пакеты от конечного узла к облачному
сетевому серверу, подключенного через мобильную или
спутниковую связь
- Один шлюз способен обслуживать несколько десятков
тысяч устройств

 _альтернатива сотовой сети, глобальная сеть, энергоэффективная сеть обмена между устройствами (интернет вещей)_

![image](https://user-images.githubusercontent.com/27426287/112759323-211c5400-8ffb-11eb-8a22-282eb29bacf3.png)



## Спутниковая связь

_две орбиты спутников чаще всего используются для спутниковой связи.СС организуется обычно там, где нельзя поставить базовую станцию, чтобы организовать ретрансляцию. Там ретранслятор выносят в космос и можно от провайдера до абонента провести линию связи_

Орбиты спутников, используемые для связи:

- Геостационарные (период обращения Земли, 4 спутника достаточно,
чтобы покрыть всю планету, над экватором 36 тыс. км)
- Низкоорбитальные (множество спутников на сотни и тыс.км, одна
земная станция поддерживает связь с 3 ближайшими спутниками)



## Стовая связь

- Зона покрытия делится на
соты с базовой станцией в
центре
- Текущее поколение сотовых
сетей: пятое со скоростями
до 20Гбит/c
- В России запрещены для
использования частоты
3,4—3,8 ГГц
- В 2020 году МТС получила
лицензию на оказание услуг
в сетях 5G в диапазоне
24,25-24,65 ГГц



# Контроллерные сети

__Контроллерная сеть__ – сеть передачи данных, связывающая в единую
коммуникационную инфраструктуру процессоры, контроллеры ввода/вывода,
датчики и исполнительные механизмы для решения задач
автоматизации/контроля технологических, химических или физических
процессов.

«Синонимы»: промышленная сеть, полевая шина (от англ. fieldbus)

### Области применения

- Автономные системы управления в автомобильной индустрии,
самолетостроении, космической отрасли.
- Автоматизация технологических процессов на производстве.
- Приложения «умный дом».

## Пирамида автоматизации 

![image](https://user-images.githubusercontent.com/27426287/112759971-01d2f600-8ffe-11eb-8409-6c1418ea9977.png)

_контроллерные сети находятся на уровне технологического оборудования, которые связывают уровень датчиков и актуаторов_

## Стандарт CAN

__CAN__ (Controller Area Network) – стандарт для построения
промышленных контроллерных сетей.

Стандарт CAN был разработан в 1983 г. компанией Bosch для
автомобильной промышленности. Первые приемопередатчики
появились в 1987 г. Стандартизирован в 1993 г. (ISO 11898).

__Примеры контроллерных сетей CAN:__

1. Системы автоматизации технологических процессов на
производстве (управление хим. процессами в фарм. индустрии,
управлении конвейерной линией сборки автомобилей и т.п.)
2. Бортовая вычислительная сеть автомобиля
3. Бортовая вычислительная система космического аппарата
4. Вычислительная система морских судов
5. Системы «умный дом»
6. и т.п.

### Каноническая схема подключения устройств к
шине CAN

_шина, по которой организуется полудуплексный канал передачи данных. Тип соединения - общая шина_ 

![image](https://user-images.githubusercontent.com/27426287/112760387-7195b080-8fff-11eb-9019-401b3b65efe1.png)

### Характеристики интерфейса CAN

- Стандарт: ISO 11898
- Проводной последовательный асинхронный интерфейс
- Полудуплексная передача данных
- Кол-во линий данных: 1 дифференциальная линия
- Макс. скорость передачи данных: до 1Мбит/с (до 40 м.)
- Расстояние передачи данных: до 1 км. (50 Кбит/с)
- Топология: общая шина

### Стек протоколов CAN

__Прикладной__ - Стандартом CAN не установлен. Определен
стандартами , CANopen, DeviceNet, SDS, Kingdom и др.

__Канальный__ - Формирование пакетов данных, обнаружение и
сигнализация об ошибках

__Физический__ - Определяет набор физических сигналов интерфейса.
Поддержка надежной передачи на уровне байтов
(кодирование, контрольная сумма, синхронизация)

### Физический уровень CAN

_2 линии, одна из которых - земля, есть рецессивный и доминантный бит для передачи нуля и единицы_

![image](https://user-images.githubusercontent.com/27426287/112760566-1c0dd380-9000-11eb-86ec-b0426dd79529.png)

### Формат пакета данных CAN

_схоже с пакетами, которые передаются в асинхронных каналах передачи даных. Есть стартовая последовательность, потом идет 11-битный идентификатор, дальше идут служебные биты, которые говорят о длинне пакета, поле данных, контрольная сумма, бит подтверждения, стоповая последовательность. Старт и стоп служит для синхнизации медлу примеником и передатчиком._

_нет защиты от неправильно введенного размера данных и есть ошибка будет в размере данных, то можно считать больше или меньше, и тогда все собъется и надо будет заново синхронизироваться по стартовым и стоповым битам_

_в устройстве пакета нет никаких адресов, все слушают передачу данных, так как все подключены под обхей шиной, и тот, кто распознал нужный id, обрабатывает пакет, но все пакеты работают широковещательно_

_поэтому есть некоторые проблемы безопасности - они защищают доступ к копоту машины, но если кто-то открыл капот (или салон) и подключился к сети CAN, тогда он сможет слушать все процессы, происходящие внутри_ 

![image](https://user-images.githubusercontent.com/27426287/112760580-2cbe4980-9000-11eb-9de1-9e69eb98627f.png)

### Принципы передачи данных CAN

-У устройств нет адресов
- Передача данных осуществляется специальными сообщениями, -
фреймами
- Каждое устройство сети может начать передачу данных
- При одновременном доступе к среде передачи данных нескольких
устройств данные не теряются, что обеспечивается алгоритмом
разрешения коллизий
- Все устройства сети могут принимать все сообщения, передаваемые по
сети
- Для повышения надежности используется бит-стаффинг (5 одинаковых бит
дополняются 6-ым инверсным).

### Арбитраж шины CAN

_узел С и узел В транслирую сначала свой id, тот у кого больше доминантных бит, то он продолжает передачу, а второй ждет начала следующей передачи_

![image](https://user-images.githubusercontent.com/27426287/112760953-85daad00-9001-11eb-9050-43e55facec2b.png)

### Канальный уровень CAN

__Типы фреймов канального уровня:__

- __DATA FRAME__ (фрейм данных) - данные от передатчика к
приемнику;
- __REMOTE FRAME__ (фрейм вызова) - передается одним из устройств
для того, чтобы получить от другого устройства данные в формате
DATA FRAME с тем же идентификатором, что и в REMOTE FRAME;
- __ERROR FRAME__ (фрейм ошибок) - передается любым устройством,
обнаружившим ошибку на шине;
- __OVERLOAD FRAME__ (фрейм перегрузки) - используется для запроса
дополнительной задержки между предыдущими и последующими
данными.

### Прикладной уровень CAN

- Прикладной уровень определяет протокол передачи сообщений
между компонентами программного обеспечения устройств сети
CAN.
- Прикладной уровень CAN не стандартизирован.
- «Популярные» реализации прикладного уровня:
- CANopen
- DeviceNet


### Пример использования CAN

![image](https://user-images.githubusercontent.com/27426287/112761107-38127480-9002-11eb-9b4f-8b2856151740.png)


## Сети LIN и FlexRay

_модификация CAN_

### LIN (Local Interconnect Network) 

_линия передачи данных, которая использует только один провод, связывает системы, как поднятие стекол в машине, управление кондеем, т.е. не жизненно важные функции. Экономия на соединении, так как прокладка одной линии_

- ISO 17987 
- Управление системами, где нет
необходимости в высокой
надежности 
- Взаимодействие между
системами со скорости реакции
человека. 
- Используется однопроводная
двунаправленная шина. 
- Максимальная скорость 20 Кбит/с

### FlexRay 

_имеет 2 канала передачи данных, дуплексный принцип,  контрольная сумма защищает поле, в котором хранится количество передаваемых данных, повышая надежность передачи даных, увеличивая скорость передачи. Используется для важных систем, например, управление тормозами_   

- ISO 17458
- Предназначен для надежной
высокоскоростной передачи
данных
- Взаимодействие между
системами в реальном
времени.
- Максимальная скорость 10
Мбит/с


## Беспроводные сенсорные сети

![image](https://user-images.githubusercontent.com/27426287/112761300-562ca480-9003-11eb-8632-c21b0f0bb009.png)


